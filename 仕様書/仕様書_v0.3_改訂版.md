# 仕様書（0.3版）

## 1. データ仕様

### 1.1 プレイヤー（書役）
| 項目名 | 型 | 説明 | 備考 |
| :--- | :--- | :--- | :--- |
| affiliation | 文字列 | 所属家 | 大名家（上司家）形式 例：織田家（羽柴家） |
| name | 文字列 | 氏名 | プレイヤーの氏名 |
| rank | 固定値 | 家格 | 家の格式・身分 |
| money | 整数 | 所持金 | **負数許容** |
| evaluation | 整数 | 主君からの評価 | 公務でのみ増加 |
| role | 固定値 | 役割 | 値："書役" |

### 1.2 村データ（村A・村B共通）
| 項目名 | 型 | 説明 | 備考 |
| :--- | :--- | :--- | :--- |
| population | 整数 | 人口 | A＞B、変動なし |
| security | 整数 | 治安 | |
| income | 整数 | 収入 | 固定、変動なし |
| development | 整数 | 開発度 | |

### 1.3 主君
| 項目名 | 型 | 説明 | 備考 |
| :--- | :--- | :--- | :--- |
| name | 文字列 | 主君名 | |
| evaluation_logic | ロジック | 評価処理 | 月次で公務実施を確認 |

## 2. 行動仕様
1日1回、以下のいずれかを選択実行する。行動は必ず成功する。

### 2.1 公務
| 行動名 | 対象 | 変動項目 | 変動方向 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| 巡察 | 村 | security<br>evaluation | ＋<br>＋ | プレイヤーのevaluationが増加 |
| 治安維持 | 村 | security<br>evaluation | 大＋<br>＋ | プレイヤーのevaluationが増加 |
| 書役仕事 | なし | evaluation | ＋ | |

### 2.2 私事
| 行動名 | 対象 | 変動項目 | 変動方向 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| 開発 | 村 | development<br>money | ＋<br>− | プレイヤーのmoneyが減少 |
| 取引 | 村商人 | money | ± | 単純な増減のみ |

## 3. 状態遷移・フロー

### 3.1 日次処理フロー
1. **行動選択**: プレイヤーが行動を1つ選択。
2. **データ反映**: 選択した行動の変動を即時反映（成功のみ）。
3. **公務フラグ更新**: 選択行動が「公務」カテゴリの場合、公務実施フラグをONにする。
4. **日付更新**: 日付を進める。
5. **月次判定**: 月末であれば月次処理へ移行。

### 3.2 月次処理フロー
1. **収入処理**: 村Aのincome ＋ 村Bのincome を計算し、プレイヤーのmoneyに加算（＋）。
2. **評価処理**: 公務実施フラグがONの場合、プレイヤーのevaluationを加算（＋）。
3. **リセット**: 公務実施フラグをOFFにする。
4. **次月移行**: 翌月の1日へ移行。

## 4. 数値変動・エッジケース仕様

### 4.1 数値変動ルール
*   **変動量**: 具体的な数値（+3など）は定義しない。方向（＋、−、大＋、±）のみに従う。
*   **自然変動**: 人口、治安、開発などの自然増減は発生しない。
*   **ランダム性**: なし。行動は必ず成功する。

### 4.2 エッジケース
*   **所持金（money）**: 負数を許容する（借金状態可）。
*   **上限・下限**: 本仕様書では規定しない（型範囲内とする）。

## 5. 初期化処理
ゲーム開始時に以下の状態でデータを初期化する。
*   **プレイヤー**: affiliation設定、name設定、rank固定、money初期値、evaluation初期値、role="書役"。
*   **村A**: population（中）、security初期値、income固定、development初期値。
*   **村B**: population（小）、security初期値、income固定、development初期値。
*   **主君**: name設定。

## 6. 非スコープ
本バージョン（0.3）では、以下の要素は実装対象外とする。

*   **戦闘**: 合戦、小競り合いなど全ての戦闘行為。
*   **調略**: 他勢力への工作、引き抜きなど。
*   **婚姻**: 結婚、家族形成。
*   **家臣団**: 部下の雇用、管理、育成。
*   **商人階層**: 村商人以外の商人、大規模な交易。
*   **世代交代**: プレイヤーキャラクターの死亡、継承。
*   **村→町→地方の発展**: 拠点規模の拡大、ランクアップ。
*   **大名AI**: 他勢力の自律的な行動。
*   **出世イベント**: 身分上昇に伴うイベント。
*   **自然増減**: 人口、治安、開発などの時間経過による自動変動。
*   **ランダムイベント**: 予測不可能な突発イベント。
*   **行動失敗**: 確率による行動の失敗。
*   **UI構築**: 画面表示、操作インターフェースの実装。
*   **旬イベント・年次イベント**: 季節や年単位で発生するイベント。

## 7. 設計背景
本仕様の策定意図は以下の通りである。

*   **プロトタイプ**: 0.3はゲーム本編ではなく、基本構造検証のためのプロトタイプである。
*   **目的**: 世界の基本フロー（日次および月次）が破綻なく動作することを確認する。
*   **最小ループ**: 書役としての最小限の日常ループ（行動→反映→評価）を構築する。
*   **拡張性**: 将来のバージョン（1.0〜3.0）に向けた骨格として、拡張を妨げないデータ構造とする。

完了
