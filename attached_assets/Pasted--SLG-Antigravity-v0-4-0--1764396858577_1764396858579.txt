あなたは「戦国立身出世SLG」プロジェクトの 実装担当（Antigravity） です。

これから v0.4 の実装フェーズ に入ってください。
以下の指示は 絶対遵守 とします。

■ 0. あなたの責務（再定義・明文化）

あなたは次を担当します：

設計（内部仕様）

コード記述

データ構造の内部最適化

ロジックの動作実装

テスト（正常系/異常系）

あなたが 絶対にしてはいけないこと：

ゲーム仕様の解釈変更

新機能の追加（“親切心の追加”も禁止）

UIデザインやレイアウトの改変

仕様書にないロジックの導入

v0.4 のスコープ外の実装

あなたの設計基準は “仕様書_v0.4.md + UIモック制作ガイド + Windsurf のHTML” だけです。

■ 1. 使用する資料（すべて変更禁止）

必ず以下を読み、
これらだけを基準に実装を行ってください。

■ 1-1. 「仕様書_v0.4.md」＝ v0.4 の機能・ロジック仕様

含まれるもの：

公務 / 私事 の行動仕様

行動結果（功績・評価・貸し・金・人口・開発度）

日付進行（日→月→年）

月次処理（集計内容）

月次サマリー表示用データ構造

データモデル（v0.4 必須分）

エッジケースの扱い

ロジックの基礎は絶対にこの仕様通りに実装すること。

■ 1-2. 「UIモック_v0.4_制作ガイド.md」＝ UIの仕様書

含まれるもの：

各画面の必須表示項目

必要な UI コンポーネント

カラーパレット・フォント・余白ルール

画面遷移

コンポーネントの命名規則

画面構造の禁止改変ポイント

画面の項目漏れ・命名ずれを発生させないこと。

■ 1-3. Windsurf の「v0.4 HTMLモック（5画面）」

メイン画面

公務選択

私事選択

行動結果ダイアログ

月次サマリー

UIの“実際の構造”として最優先で参照してください。

UIはこの HTML を基準に構築します。
（ロジックは仕様書_v0.4.md優先）

■ 1-4. 和風UI Style Guide（v0.3から継続）

UIデザインの統一のため、
UIの外観は Style Guide > Windsurfモック > 制作ガイド > v0.4仕様書 の順で優先
※表示項目は仕様書優先、見た目はStyleGuide優先。

■ 1-5. 過去バージョン（v0.3）実装

v0.3 の実装を 壊さず に拡張すること

UI構造の互換性を維持すること

■ 2. v0.4 で実装すべき「完成形の状態」

あなたが実装した v0.4 は、プレイヤーが以下を行える状態になっていなければならない。

【A】1日につき 1回、行動（公務 or 私事）を実行できる

公務：功績・評価・貸し・治安・開発度の変動

私事：金・人口・開発度の変動

私事では功績が絶対に発生しない（仕様）


【B】行動結果が「ダイアログ」と「行動ログ」に反映される

行動結果ダイアログは Windsurf HTML の構造を再現

行動ログはメイン画面右の簡易ログ（最新5件）

【C】日付が「日 → 月 → 年」と正しく進行する

日付+1

月の境界超え → 月次処理 → 月次サマリー

サマリー後「次月へ」でメインへ戻る


【D】月次サマリーに以下を正しく表示できる

公務回数

公務成功率（v0.4は100%）

功績増分（軍事/政務/密功）

評価変化

金の収支

村A/B の人口・開発の増分

これらは 仕様書_v0.4.md の DTO 仕様 に合わせる。

【E】村A/B（2村）の状態が正常に変動する

治安（公務）

開発度（公務・私事）

人口（私事）

収入（月次）

【F】データモデル（仕様書 9章）を完全に満たす

House

Lord

Village

OfficialDuty

PrivateAction

DailyLog

MonthlySummary

GameState（中央管理）

構造変更は禁止。
内部追加フィールドは許可するが、仕様を変える用途に使わないこと。

■ 3. v0.4 で絶対に実装してはいけないもの（禁止）

以下は コードにも UI にも出してはいけない。

戦闘 / 軍事AI / 部隊 / 出陣

家臣団（採用・忠誠・育成・補佐官 etc.）

任官・辞令・出世イベント

婚姻・世代交代

引き抜き（浪人・陪臣）

調略（埋伏 etc.）

評定（会議UI・政治AI）

主命（特別ミッション）

旬イベント・年次イベント

ランダムイベント

天候 / 兵站 / 損害計算

自動増加・自然減少（人口・治安 etc.）

v0.4 のスコープ外の機能は完全禁止
理由：ロードマップと別紙の整合を守るため。

■ 4. 実装順序（Antigravityが迷わない鉄板手順）

これは 実装ミスを防ぐ最適順 です。
この順に実装すると破綻しません。

① データモデルの拡張

（仕様書 9章をそのまま実装）

Village

DailyLog

MonthlySummary

功績3系統

貸し（簡易版）

② 時間進行（日→月→年）の実装

（仕様書 3章）

日付+1

月末判定

月次処理呼び出し

③ 公務ロジック 6種の実装

（治安維持 / 巡察 / 検地補助 / 普請補助 / 書状作成 / 情報収集）

必ず「常に成功」（v0.4仕様の明示）

公務→功績発生

文言や分類は仕様書どおり

④ 私事ロジック 4種の実装

功績が絶対に 0

金・人口・開発度の変動のみ

⑤ 行動結果ダイアログ（UI連携）

UIモック制作ガイド 6章の形式をそのまま使う

値の前後差を表示

Windsurf のHTML構造に数値をバインド

⑥ 月次処理 → 月次サマリー

公務回数

功績の当月差

評価変化

村A/Bの変化

金収支

すべて仕様書どおり。
UIは Windsurf HTML に従う。

⑦ メイン画面の右パネルの更新

行動結果をログに5件保持

当日の功績・金・開発などを反映

HTML構造は Windsurf に従う

⑧ 総合テスト（1ヶ月分 → 3ヶ月分）

行動→ログ→日付→月跨ぎ→サマリー→復帰

破綻が起きないこと

■ 5. テスト観点（必須チェック）

公務実行→功績が増える

私事実行→功績は増えない（最重要）

貸しは「検地補助」「情報収集」のみ増加

村A/B が正しく変動

月次サマリーの数値が仕様書と一致

左ナビは v0.3 の構造を維持

未実装タブはクリック不可 or 無反応

v0.3 互換（レイアウト破損なし）

■ 6. 完了条件

次の状態に達したとき、v0.4 実装は完了です。

メイン画面・公務選択・私事選択・行動結果ダイアログ・月次サマリーの UI反映が完全

公務・私事の内部ロジックが 仕様書通り

月次処理・日付進行が 正確

データ構造が仕様書と 整合

エラーなく1ヶ月をプレイできる

v0.3 互換が壊れていない

完了したら、必ず：

「v0.4 実装が完了しました」

とだけ返してください。
次の v0.5 には 絶対に勝手に進まないこと。