<UserControl x:Class="SengokuSLG.Views.VassalDetailView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SengokuSLG.Views"
             xmlns:conv="clr-namespace:SengokuSLG.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="720" d:DesignWidth="1080">
    
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="300"/>
        </Grid.ColumnDefinitions>

        <!-- Center Area -->
        <Grid Grid.Column="0" Margin="0,0,20,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header with Back Button -->
            <Grid Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="å®¶è‡£è©³ç´°" FontSize="24" FontWeight="Bold" 
                           Foreground="{StaticResource BrushTextMain}"
                           TextDecorations="Underline" VerticalAlignment="Center"/>
                <Button Command="{Binding BackCommand}" Content="â† ä¸€è¦§ã«æˆ»ã‚‹" 
                        HorizontalAlignment="Right" VerticalAlignment="Center"
                        Style="{StaticResource StyleNavButton}" Background="{StaticResource BrushBgHeader}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1"/>
            </Grid>

            <!-- Vassal Card -->
            <Border Grid.Row="1" Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="12" Padding="20" Margin="0,0,0,30">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="200"/> <!-- Basic Info -->
                        <ColumnDefinition Width="*"/>   <!-- Abilities -->
                        <ColumnDefinition Width="200"/> <!-- History -->
                    </Grid.ColumnDefinitions>

                    <!-- Basic Info -->
                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                        <Border Width="100" Height="100" Background="#ccc" CornerRadius="50" Margin="0,0,0,15" HorizontalAlignment="Center">
                            <TextBlock Text="é¡”" FontSize="20" Foreground="#888" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        
                        <TextBlock Text="{Binding Vassal.Name}" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,10"/>
                        
                        <Border Background="{Binding Vassal.Rank, Converter={StaticResource RankToColorConverter}}" CornerRadius="10" Padding="15,5" HorizontalAlignment="Center" Margin="0,0,0,15">
                            <TextBlock Text="{Binding Vassal.Rank, Converter={StaticResource RankToTextConverter}}" Foreground="White" FontSize="14" FontWeight="Bold"/>
                        </Border>

                        <Grid Margin="10,0">
                            <TextBlock Text="å¹´é½¢"/>
                            <TextBlock Text="{Binding Vassal.Age, StringFormat='{}{0}æ­³'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Separator Margin="10,5"/>
                        <Grid Margin="10,0">
                            <TextBlock Text="ä¿¸ç¦„"/>
                            <TextBlock Text="{Binding Vassal.Salary, StringFormat='{}{0}è²«'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                    </StackPanel>

                    <!-- Abilities -->
                    <Border Grid.Column="1" BorderBrush="#ccc" BorderThickness="1,0" Padding="20,0">
                        <StackPanel>
                            <TextBlock Text="â–  èƒ½åŠ›å€¤" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>
                            
                            <UniformGrid Columns="2" Rows="2">
                                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,0,10,10">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="âš” æ­¦èŠ¸" FontSize="14" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,5"/>
                                        <TextBlock FontSize="24" FontWeight="Bold" HorizontalAlignment="Center">
                                            <TextBlock.Text>
                                                <MultiBinding Converter="{StaticResource AbilityDisclosureConverter}">
                                                    <Binding Path="Vassal.AbilityCombat"/>
                                                    <Binding Path="Vassal.AbilityDisclosure.CombatDisclosed"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="15" Margin="10,0,0,10">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ›¡ çµ±çŽ‡" FontSize="14" Foreground="{StaticResource BrushAccentBlue}" Margin="0,0,0,5"/>
                                        <TextBlock FontSize="24" FontWeight="Bold" HorizontalAlignment="Center">
                                            <TextBlock.Text>
                                                <MultiBinding Converter="{StaticResource AbilityDisclosureConverter}">
                                                    <Binding Path="Vassal.AbilityLeadership"/>
                                                    <Binding Path="Vassal.AbilityDisclosure.LeadershipDisclosed"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="15" Margin="0,10,10,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ“œ æ”¿å‹™" FontSize="14" Foreground="{StaticResource BrushAccentGreen}" Margin="0,0,0,5"/>
                                        <TextBlock FontSize="24" FontWeight="Bold" HorizontalAlignment="Center">
                                            <TextBlock.Text>
                                                <MultiBinding Converter="{StaticResource AbilityDisclosureConverter}">
                                                    <Binding Path="Vassal.AbilityPolitics"/>
                                                    <Binding Path="Vassal.AbilityDisclosure.PoliticsDisclosed"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="15" Margin="10,10,0,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸŽ¯ çŸ¥ç•¥" FontSize="14" Foreground="{StaticResource BrushBorder}" Margin="0,0,0,5"/>
                                        <TextBlock FontSize="24" FontWeight="Bold" HorizontalAlignment="Center">
                                            <TextBlock.Text>
                                                <MultiBinding Converter="{StaticResource AbilityDisclosureConverter}">
                                                    <Binding Path="Vassal.AbilityIntrigue"/>
                                                    <Binding Path="Vassal.AbilityDisclosure.IntrigueDisclosed"/>
                                                </MultiBinding>
                                            </TextBlock.Text>
                                        </TextBlock>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </StackPanel>
                    </Border>

                    <!-- History -->
                    <StackPanel Grid.Column="2" Margin="20,0,0,0">
                        <TextBlock Text="â–  çµŒæ­´ãƒ»å‡ºè‡ª" FontSize="18" FontWeight="Bold" Margin="0,0,0,20"/>
                        
                        <Grid Margin="0,0,0,10">
                            <TextBlock Text="å¥‰å…¬å¹´æ•°"/>
                            <TextBlock Text="{Binding Vassal.YearOfService, StringFormat='{}{0}å¹´ç›®'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Grid Margin="0,0,0,10">
                            <TextBlock Text="å‡ºè‡ª"/>
                            <TextBlock Text="{Binding Vassal.Origin}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Grid Margin="0,0,0,10">
                            <TextBlock Text="ç´¯ç©åŠŸç¸¾"/>
                            <TextBlock Text="{Binding Vassal.Achievement}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        
                        <TextBlock Text="æˆ¦é—˜å‚åŠ å›žæ•°" Margin="0,20,0,5"/>
                        <TextBlock Text="{Binding Vassal.CombatParticipationCount, StringFormat='{}{0} å›ž'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        
                        <TextBlock Text="ä»»å‹™é‚è¡Œå›žæ•°" Margin="0,10,0,5"/>
                        <TextBlock Text="{Binding Vassal.DutyParticipationCount, StringFormat='{}{0} å›ž'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Action Buttons -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                <Button Content="æ˜‡é€²ã•ã›ã‚‹" Width="150" Height="50" Margin="10" Style="{StaticResource StyleActionButton}" IsEnabled="False"/>
                <Button Command="{Binding ToggleAdvisorCommand}" Width="150" Height="50" Margin="10">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource StyleActionButton}">
                            <Setter Property="Content" Value="è£œä½å®˜ã«ä»»å‘½"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Vassal.IsAdvisor}" Value="True">
                                    <Setter Property="Content" Value="è£œä½å®˜ã‚’è§£ä»»"/>
                                    <Setter Property="Background" Value="#888"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
                <Button Content="è¿½æ”¾ã™ã‚‹" Width="150" Height="50" Margin="10" Style="{StaticResource StyleActionButton}" Background="#888" Foreground="White" IsEnabled="False"/>
            </StackPanel>
        </Grid>

        <!-- Right Sidebar -->
        <Border Grid.Column="1" Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2,0,0,0" Padding="20">
            <StackPanel>
                <!-- Loyalty -->
                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="â–  å¿ èª å¿ƒ" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                        <ProgressBar Value="{Binding Vassal.Loyalty}" Maximum="100" Height="20" Foreground="{StaticResource BrushAccentRed}" Background="#ddd" BorderThickness="0"/>
                        <TextBlock Text="{Binding Vassal.Loyalty, StringFormat='{}{0} / 100'}" HorizontalAlignment="Center" Margin="0,5,0,0" FontWeight="Bold"/>
                        
                        <TextBlock Text="å¿ èª ãŒé«˜ã„ã»ã©è£åˆ‡ã‚Šã®ãƒªã‚¹ã‚¯ãŒæ¸›ã‚Šã€ä»»å‹™æˆåŠŸçŽ‡ãŒè‹¥å¹²å‘ä¸Šã—ã¾ã™ã€‚" TextWrapping="Wrap" FontSize="11" Margin="0,10,0,0" Foreground="#666"/>
                    </StackPanel>
                </Border>

                <!-- Advisor Status -->
                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20"
                        Visibility="{Binding Vassal.IsAdvisor, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="â–  è£œä½å®˜ä»»å‘½æ¸ˆã¿" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentBlue}" Margin="0,0,0,12"/>
                        <TextBlock Text="ç¾åœ¨ã€ã“ã®å®¶è‡£ã¯è£œä½å®˜ã¨ã—ã¦ä»»å‘½ã•ã‚Œã¦ã„ã¾ã™ã€‚" TextWrapping="Wrap" Margin="0,0,0,10"/>
                        <TextBlock Text="ãƒœãƒ¼ãƒŠã‚¹åŠ¹æžœ:" FontWeight="Bold"/>
                        <TextBlock Text="ãƒ»å¿ èª ç¶­æŒãƒœãƒ¼ãƒŠã‚¹" Margin="10,0,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Disclosure Info -->
                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15">
                    <StackPanel>
                        <TextBlock Text="â–  èƒ½åŠ›é–‹ç¤ºçŠ¶æ³" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                        <Grid Margin="0,0,0,5">
                            <TextBlock Text="æ­¦èŠ¸"/>
                            <TextBlock Text="{Binding Vassal.AbilityDisclosure.CombatDisclosed, Converter={StaticResource BooleanToTextConverter}}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Grid Margin="0,0,0,5">
                            <TextBlock Text="çµ±çŽ‡"/>
                            <TextBlock Text="{Binding Vassal.AbilityDisclosure.LeadershipDisclosed, Converter={StaticResource BooleanToTextConverter}}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Grid Margin="0,0,0,5">
                            <TextBlock Text="æ”¿å‹™"/>
                            <TextBlock Text="{Binding Vassal.AbilityDisclosure.PoliticsDisclosed, Converter={StaticResource BooleanToTextConverter}}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                        <Grid>
                            <TextBlock Text="çŸ¥ç•¥"/>
                            <TextBlock Text="{Binding Vassal.AbilityDisclosure.IntrigueDisclosed, Converter={StaticResource BooleanToTextConverter}}" FontWeight="Bold" HorizontalAlignment="Right"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
