<UserControl x:Class="SengokuSLG.Views.MainView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SengokuSLG.Views"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="250"/>
        </Grid.ColumnDefinitions>

        <!-- Left Sidebar: Player Info -->
        <Border Grid.Column="0" Background="{StaticResource BrushPanelBg}" BorderBrush="#8b4513" BorderThickness="0,0,2,0">
            <StackPanel Margin="15">
                <TextBlock Text="【主人公】" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBlock Text="{Binding Player.Name}" FontSize="18" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.Affiliation}" FontSize="12" Foreground="#555" Margin="0,0,0,20"/>

                <TextBlock Text="身分: 地侍" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.Rank, StringFormat='役職: {0}'}" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.Money, StringFormat='所持金: {0}貫'}" FontWeight="Bold" Margin="0,0,0,20"/>

                <Separator Background="#8b4513" Margin="0,0,0,15"/>

                <TextBlock Text="【評価・功績】" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>
                <TextBlock Text="{Binding Player.Evaluation, StringFormat='評価: {0}'}" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.AchievementMilitary, StringFormat='軍事功: {0}'}" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.AchievementPolitical, StringFormat='政務功: {0}'}" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.AchievementSecret, StringFormat='密功: {0}'}" Margin="0,0,0,5"/>
                <TextBlock Text="{Binding Player.Favor, StringFormat='貸し: {0}'}" Margin="0,0,0,5"/>
            </StackPanel>
        </Border>

        <!-- Center: Action Area -->
        <Grid Grid.Column="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Date Display -->
            <Border Grid.Row="0" Background="{StaticResource BrushHeader}" Padding="15" CornerRadius="8" Margin="0,0,0,20">
                <TextBlock Text="{Binding CurrentDateDisplay}" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center" Foreground="#2b2b2b"/>
            </Border>

            <!-- Action Buttons -->
            <StackPanel Grid.Row="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock Text="本日の行動を選択してください" FontSize="16" HorizontalAlignment="Center" Margin="0,0,0,30"/>

                <Button Command="{Binding NavigatePublicDutyCommand}" Content="公務を行う" 
                        Style="{StaticResource StyleActionButton}" Width="250" Height="60" Margin="0,0,0,20"
                        IsEnabled="{Binding IsPublicDutyDone, Converter={StaticResource InverseBooleanConverter}}"/>
                
                <Button Command="{Binding NavigatePrivateTaskCommand}" Content="私事を行う" 
                        Style="{StaticResource StyleActionButton}" Width="250" Height="60"/>
                
                <TextBlock Text="※公務は月1回必須です" FontSize="12" Foreground="#c73940" HorizontalAlignment="Center" Margin="0,10,0,0"
                           Visibility="{Binding IsPublicDutyDone, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}"/>
                <TextBlock Text="今月の公務は完了しています" FontSize="12" Foreground="#2d7a3e" HorizontalAlignment="Center" Margin="0,10,0,0"
                           Visibility="{Binding IsPublicDutyDone, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            </StackPanel>
        </Grid>

        <!-- Right Sidebar: Log -->
        <Border Grid.Column="2" Background="{StaticResource BrushPanelBg}" BorderBrush="#8b4513" BorderThickness="2,0,0,0">
            <Grid Margin="15">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Text="【行動履歴】" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                
                <ItemsControl Grid.Row="1" ItemsSource="{Binding Logs}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}" TextWrapping="Wrap" Margin="0,0,0,8" FontSize="12"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Grid>
        </Border>
    </Grid>
</UserControl>
