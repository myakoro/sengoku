<UserControl x:Class="SengokuSLG.Views.MainView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:SengokuSLG.Views"
             xmlns:conv="clr-namespace:SengokuSLG.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="720" d:DesignWidth="1080">
    
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="320"/>
        </Grid.ColumnDefinitions>

        <!-- Center Area -->
        <Grid Grid.Column="0" Margin="0,0,20,0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Section Title -->
            <TextBlock Grid.Row="0" Text="ä»Šæ—¥ã®è¡Œå‹•ã‚’é¸ã¶" FontSize="24" FontWeight="Bold" Margin="0,0,0,20"
                       Foreground="{StaticResource BrushTextMain}"
                       TextDecorations="Underline"/>

            <!-- Action Buttons -->
            <UniformGrid Grid.Row="1" Columns="2" Rows="3" Margin="0,0,0,30">
                <Button Command="{Binding NavigatePublicDutyCommand}" Style="{StaticResource StyleActionButton}" Margin="0,0,10,10" Height="100"
                        IsEnabled="{Binding IsPublicDutyDone, Converter={StaticResource InverseBooleanConverter}}">
                    <StackPanel>
                        <TextBlock Text="å…¬å‹™ã‚’è¡Œã†" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                        <TextBlock Text="ä¸»å®¶ã®ãŸã‚ã«åƒãã€åŠŸç¸¾ã‚’ç©ã‚€" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Command="{Binding NavigatePrivateTaskCommand}" Style="{StaticResource StyleActionButton}" Margin="10,0,0,10" Height="100">
                    <StackPanel>
                        <TextBlock Text="ç§äº‹ã‚’è¡Œã†" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                        <TextBlock Text="è‡ªå®¶ã®ç™ºå±•ã®ãŸã‚ã«è¡Œå‹•ã™ã‚‹" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Command="{Binding NavigateVassalListCommand}" Style="{StaticResource StyleActionButton}" Margin="0,10,10,10" Height="100">
                    <StackPanel>
                        <TextBlock Text="å®¶è‡£ä¸€è¦§" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                        <TextBlock Text="å®¶è‡£ã®ç®¡ç†ãƒ»æ˜‡æ ¼ã‚’è¡Œã†" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Command="{Binding NavigateAdvisorSettingCommand}" Style="{StaticResource StyleActionButton}" Margin="10,10,0,10" Height="100">
                    <StackPanel>
                        <TextBlock Text="è£œä½å®˜è¨­å®š" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                        <TextBlock Text="è£œä½å®˜ã®ä»»å‘½ãƒ»å¤‰æ›´ã‚’è¡Œã†" FontSize="12" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Command="{Binding ExecuteBattleCommand}" Style="{StaticResource StyleActionButton}" Margin="0,10,10,0" Height="100" Background="#8B0000">
                    <StackPanel>
                        <TextBlock Text="ã€ãƒ†ã‚¹ãƒˆã€‘æˆ¦é—˜å®Ÿè¡Œ" FontSize="20" FontWeight="Bold" HorizontalAlignment="Center" Margin="0,0,0,5" Foreground="White"/>
                        <TextBlock Text="v0.6 æˆ¦é—˜AIã®ãƒ†ã‚¹ãƒˆ" FontSize="12" HorizontalAlignment="Center" Foreground="White"/>
                    </StackPanel>
                </Button>
            </UniformGrid>

            <!-- Territory Panel -->
            <Border Grid.Row="2" Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="12" Padding="20">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="â–  çŸ¥è¡Œã®æ¦‚æ³" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                    
                    <ItemsControl Grid.Row="1" ItemsSource="{Binding Service.Villages}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="2"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="8" Padding="15" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
                                        <Grid Margin="0,0,0,5">
                                            <TextBlock Text="äººå£" HorizontalAlignment="Left"/>
                                            <TextBlock Text="{Binding Population, StringFormat='{}{0}äºº'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid Margin="0,0,0,5">
                                            <TextBlock Text="æ²»å®‰" HorizontalAlignment="Left"/>
                                            <TextBlock Text="{Binding Security}" FontWeight="Bold" HorizontalAlignment="Right"/>
                                        </Grid>
                                        <Grid>
                                            <TextBlock Text="é–‹ç™º" HorizontalAlignment="Left"/>
                                            <TextBlock Text="{Binding Development}" FontWeight="Bold" HorizontalAlignment="Right"/>
                                        </Grid>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>
            </Border>
        </Grid>

        <!-- Right Sidebar -->
        <Border Grid.Column="1" Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2,0,0,0" Padding="20">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <!-- Player Info -->
                    <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="{Binding Service.Player.Affiliation, StringFormat='â–  æ‰€å±žå®¶ {0}'}" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                            
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="æ°å"/>
                                <TextBlock Text="{Binding Service.Player.Name}" FontWeight="Bold" HorizontalAlignment="Right"/>
                            </Grid>
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="å½¹è·"/>
                                <Border Background="{Binding Service.Player.Rank, Converter={StaticResource RankToColorConverter}}" CornerRadius="10" Padding="10,2" HorizontalAlignment="Right">
                                    <TextBlock Text="{Binding Service.Player.Rank, Converter={StaticResource RankToTextConverter}}" Foreground="White" FontSize="12" FontWeight="Bold"/>
                                </Border>
                            </Grid>
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="å®¶æ ¼"/>
                                <TextBlock Text="{Binding Service.Player.HouseGrade}" FontWeight="Bold" HorizontalAlignment="Right"/>
                            </Grid>
                            <Grid>
                                <TextBlock Text="æ‰€æŒé‡‘"/>
                                <TextBlock Text="{Binding Service.Player.Money, StringFormat='{}{0}è²«'}" FontWeight="Bold" HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Abilities -->
                    <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="â–  èƒ½åŠ›ï¼ˆè£œä½å®˜è£œæ­£è¾¼ã¿ï¼‰" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                            
                            <UniformGrid Columns="2" Rows="2">
                                <!-- Combat -->
                                <Border Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="10" Margin="0,0,5,5">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="âš”" FontSize="20" Foreground="{StaticResource BrushAccentRed}" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <TextBlock Text="å€‹äººæˆ¦é—˜" FontSize="10" Foreground="#666" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <TextBlock Text="{Binding Service.Player.AbilityCombat}" FontSize="18" FontWeight="Bold" HorizontalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <!-- Leadership -->
                                <Border Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="10" Margin="5,0,0,5">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ›¡" FontSize="20" Foreground="{StaticResource BrushAccentBlue}" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <TextBlock Text="çµ±çŽ‡" FontSize="10" Foreground="#666" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding Service.Player.AbilityLeadership}" FontSize="18" FontWeight="Bold"/>
                                            <TextBlock Text="+?" FontSize="14" Foreground="{StaticResource BrushAccentGreen}" Margin="3,0,0,0" Visibility="{Binding HasAdvisor, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <!-- Politics -->
                                <Border Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="10" Margin="0,5,5,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸ“œ" FontSize="20" Foreground="{StaticResource BrushAccentGreen}" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <TextBlock Text="æ”¿å‹™" FontSize="10" Foreground="#666" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding Service.Player.AbilityPolitics}" FontSize="18" FontWeight="Bold"/>
                                            <TextBlock Text="+?" FontSize="14" Foreground="{StaticResource BrushAccentGreen}" Margin="3,0,0,0" Visibility="{Binding HasAdvisor, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                                <!-- Intrigue -->
                                <Border Background="{StaticResource BrushBgPanel}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="1" CornerRadius="6" Padding="10" Margin="5,5,0,0">
                                    <StackPanel HorizontalAlignment="Center">
                                        <TextBlock Text="ðŸŽ¯" FontSize="20" Foreground="{StaticResource BrushBorder}" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <TextBlock Text="çŸ¥ç•¥" FontSize="10" Foreground="#666" HorizontalAlignment="Center" Margin="0,0,0,5"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <TextBlock Text="{Binding Service.Player.AbilityIntrigue}" FontSize="18" FontWeight="Bold"/>
                                            <TextBlock Text="+?" FontSize="14" Foreground="{StaticResource BrushAccentGreen}" Margin="3,0,0,0" Visibility="{Binding HasAdvisor, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                        </StackPanel>
                    </Border>

                    <!-- Achievement -->
                    <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="â–  åŠŸç¸¾" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                            <Grid>
                                <TextBlock Text="ç´¯ç©åŠŸç¸¾"/>
                                <TextBlock Text="{Binding Service.Player.Achievement}" FontWeight="Bold" HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Juboku Slots -->
                    <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15" Margin="0,0,0,20">
                        <StackPanel>
                            <TextBlock Text="â–  å¾“åƒ•æž ï¼ˆè­·è¡›å°éšŠï¼‰" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                            <Grid Margin="0,0,0,8">
                                <TextBlock Text="ç¾åœ¨ / ä¸Šé™"/>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Text="{Binding Service.Player.JubokuIds.Count}" FontWeight="Bold"/>
                                    <TextBlock Text=" / "/>
                                    <TextBlock Text="{Binding Service.Player.JubokuSlots}" FontWeight="Bold"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Action Log -->
                    <Border Background="{StaticResource BrushBgCard}" BorderBrush="{StaticResource BrushBorder}" BorderThickness="2" CornerRadius="8" Padding="15">
                        <StackPanel>
                            <TextBlock Text="â–  è¡Œå‹•ãƒ­ã‚°" FontSize="16" FontWeight="Bold" Foreground="{StaticResource BrushAccentRed}" Margin="0,0,0,12"/>
                            <ItemsControl ItemsSource="{Binding Service.Logs}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding}" TextWrapping="Wrap" Margin="0,0,0,8" FontSize="12" LineHeight="16"/>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>
